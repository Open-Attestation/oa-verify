digraph G {

    node [style=filled];
    label = "openAttestationHash.ts"

  subgraph cluster_1 {

    label = "test"

    start_test [label="Start"]
    valid_test [label= "Valid" URL="https://github.com/Open-Attestation/oa-verify/blob/080d82ed7223a1f29d7b8fee6e3f3e466c72227c/src/verifiers/documentIntegrity/hash/openAttestationHash.ts#L28"];
    v2 [label="v2"]
    v3 [label="v3"]
    invalid_test [label= "Skipped"];
    
    start_test -> v2 [label="isWrappedV2Document"];
    start_test -> v3 [label="isWrappedV3Document"];
    v2 -> valid_test [label="proof type OpenAttestationSignature2018"];
    v2 -> invalid_test
    v3 -> valid_test [label="proof type OpenAttestationMerkleProofSignature2018"];
    v3-> invalid_test
    start_test -> invalid_test [label="Neither"];
  }

  
  subgraph cluster_2 {

    label = "verify"
    
    valid [label= "Valid"];
    invalid [label= "Invalid"];

    verify_start_verify [label="Start"]
    valid_test -> verify_start_verify;
    
    
    verify_start_verify -> v2_valid_identity_type_verify [label = "isSignedWrappedV2Document"]
    verify_start_verify -> invalid

    v2_valid_identity_type_verify [label="valid v2 identity type"]
    v2_valid_identity_type_verify -> v2_check_issuer_details [label="IdentityProofType DID"];
    v2_valid_identity_type_verify -> v2_check_issuer_details [label="IdentityProofType DNS-DID"];
    v2_valid_identity_type_verify -> invalid
    
    v2_check_issuer_details [label="check revocation details"]
    v2_check_issuer_details -> v2_verify_dns_txt_verify [label="valid revocation url/address"];
    v2_check_issuer_details -> invalid

    v2_verify_dns_txt_verify [label="verify document revocation"]
    v2_verify_dns_txt_verify -> invalid
    v2_verify_dns_txt_verify -> v2_verify_signature [label="None"]
    v2_verify_dns_txt_verify -> v2_verify_revocationstore [label="Revocation type RevocationStore"]
    v2_verify_dns_txt_verify -> v2_verify_ocspresponder [label="Revocation type OcspResponder"]

    v2_verify_revocationstore [label="verify document RevocationStore"]
    v2_verify_revocationstore -> v2_verify_signature [label="document not on RevocationStore"]
    v2_verify_revocationstore -> invalid

    v2_verify_ocspresponder [label="verify document OcspResponder"]
    v2_verify_ocspresponder -> v2_verify_signature [label="document not on OcspResponder"]
    v2_verify_ocspresponder -> invalid

    v2_verify_signature [label="verify document signature"]
    v2_verify_signature -> valid [label="document signature valid"]
    v2_verify_signature -> invalid
    
  }


  subgraph cluster_3 {

    
    verify_start_verify -> v3_verify_signature [label = "isSignedWrappedV3Document"]
    verify_start_verify -> invalid


    v3_verify_signature [label="verify document signature"]
    v3_verify_signature -> v3_check_issuer_details [label="document signature valid"]
    v3_verify_signature -> invalid

    // v3_valid_identity_type_verify [label="valid v3 identity type"]
    // v3_valid_identity_type_verify -> v3_check_issuer_details [label="IdentityProofType DID"];
    // v3_valid_identity_type_verify -> v3_check_issuer_details [label="IdentityProofType DNS-DID"];
    // v3_valid_identity_type_verify -> invalid
    
    v3_check_issuer_details [label="check revocation details"]
    v3_check_issuer_details -> v3_verify_dns_txt_verify [label="valid revocation url/address"];
    v3_check_issuer_details -> invalid

    v3_verify_dns_txt_verify [label="verify document revocation"]
    v3_verify_dns_txt_verify -> invalid
    v3_verify_dns_txt_verify -> valid [label="None"]
    v3_verify_dns_txt_verify -> v3_verify_revocationstore [label="Revocation type RevocationStore"]
    // v3_verify_dns_txt_verify -> invalid [label="Revocation type OcspResponder"]

    v3_verify_revocationstore [label="verify document RevocationStore"]
    v3_verify_revocationstore -> valid [label="document not on RevocationStore"]
    v3_verify_revocationstore -> invalid

    // v3_verify_ocspresponder [label="verify document OcspResponder"]
    // v3_verify_ocspresponder -> v3_verify_signature [label="document not on OcspResponder"]
    // v3_verify_ocspresponder -> invalid

    
  }


  subgraph cluster_4 {

    label = "skip"
    invalid_test -> skip;
  }

}